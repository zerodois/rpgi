<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Web RTC</title>
</head>
<body>
  <div id="wrapper">
    <h1>Web Cam</h1>
    <video id="webcam" autoplay></video>
  </div>
</body>
<script type="text/javascript" src="/js/rtc/adapter.js"></script>
<script type="text/javascript" src="/js/rtc/common.js"></script>
<script type="text/javascript">
	var errorElement = document.querySelector('#errorMsg');
	var video = document.querySelector('video');

	// Put variables in global scope to make them available to the browser console.
	var constraints = window.constraints = {
	  audio: true,
	  video: true
	};

	function handleSuccess(stream) {
	  var videoTracks = stream.getVideoTracks();
	  console.log('Got stream with constraints:', constraints);
	  console.log('Using video device: ' + videoTracks[0].label);
	  stream.oninactive = function() {
	    console.log('Stream inactive');
	  };
	  window.stream = stream; // make variable available to browser console
	  video.srcObject = stream;
	}

	function handleError(error) {
	  if (error.name === 'ConstraintNotSatisfiedError') {
	    errorMsg('The resolution ' + constraints.video.width.exact + 'x' +
	        constraints.video.width.exact + ' px is not supported by your device.');
	  } else if (error.name === 'PermissionDeniedError') {
	    errorMsg('Permissions have not been granted to use your camera and ' +
	      'microphone, you need to allow the page access to your devices in ' +
	      'order for the demo to work.');
	  }
	  errorMsg('getUserMedia error: ' + error.name, error);
	}

	function errorMsg(msg, error) {
	  errorElement.innerHTML += '<p>' + msg + '</p>';
	  if (typeof error !== 'undefined') {
	    console.error(error);
	  }
	}

	navigator.mediaDevices.getUserMedia(constraints).
    then(handleSuccess).catch(handleError);
</script>
</html>